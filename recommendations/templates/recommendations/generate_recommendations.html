{% extends 'recommendations/base.html' %}

{% block content %}
<div class="recommendations-container">
    <h1 class="page-title"><i class="fas fa-star"></i> Generate College Recommendations</h1>
    
    <div class="steps-indicator">
        <div class="step active"><span>1</span> Enter Details</div>
        <div class="step"><span>2</span> Set Preferences</div>
        <div class="step"><span>3</span> View Results</div>
    </div>
    
    <div class="form-section">
        <h2><i class="fas fa-user-edit"></i> Student Information</h2>
        <form id="studentForm" class="student-form">
            <div class="form-row">
                <div class="form-group">
                    <label><i class="fas fa-user"></i> Full Name</label>
                    <input type="text" id="studentName" required placeholder="Enter your name">
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Email</label>
                    <input type="email" id="studentEmail" required placeholder="student@example.com">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label><i class="fas fa-chart-bar"></i> Marks Obtained (%)</label>
                    <input type="number" id="studentMarks" min="0" max="100" required value="85">
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-tag"></i> Category</label>
                    <select id="studentCategory" required>
                        <option value="General">General</option>
                        <option value="OBC">OBC</option>
                        <option value="SC">SC</option>
                        <option value="ST">ST</option>
                    </select>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label><i class="fas fa-book"></i> Preferred Course</label>
                    <select id="preferredCourse" required>
                        <option value="BTech">BTech</option>
                        <option value="BSc">BSc</option>
                        <option value="BA">BA</option>
                        <option value="BCom">BCom</option>
                        <option value="MBA">MBA</option>
                        <option value="MCA">MCA</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-map-marker-alt"></i> Preferred Location</label>
                    <input type="text" id="preferredLocation" placeholder="e.g., Mumbai, Delhi">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label><i class="fas fa-rupee-sign"></i> Annual Budget (₹)</label>
                    <input type="number" id="studentBudget" min="50000" value="200000" step="50000">
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-reset">
                    <i class="fas fa-redo"></i> Reset
                </button>
                <button type="submit" class="btn btn-generate">
                    <i class="fas fa-magic"></i> Generate Recommendations
                </button>
            </div>
        </form>
    </div>
    
    <div class="results-section" id="resultsSection" style="display: none;">
        <h2><i class="fas fa-trophy"></i> Your Top Recommendations</h2>
        <div class="results-grid" id="resultsGrid">
            <!-- Results will appear here -->
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('studentForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Show loading
    document.getElementById('resultsSection').style.display = 'block';
    document.getElementById('resultsGrid').innerHTML = '<div class="loading">Generating recommendations...</div>';
    
    // Simulate API call (replace with actual fetch)
    setTimeout(() => {
        const mockResults = [
            { name: "ABC Institute", score: 8.6, stars: 4.3, location: "Mumbai", fees: "₹1,20,000", placement: "85%" },
            { name: "Delhi Engineering", score: 8.2, stars: 4.1, location: "Delhi", fees: "₹1,50,000", placement: "90%" },
            { name: "Bangalore Science", score: 7.8, stars: 3.9, location: "Bangalore", fees: "₹80,000", placement: "78%" },
        ];
        
        renderResults(mockResults);
    }, 1500);
});

function renderResults(results) {
    const grid = document.getElementById('resultsGrid');
    grid.innerHTML = '';
    
    results.forEach((college, index) => {
        const stars = '★'.repeat(Math.floor(college.stars)) + '☆'.repeat(5 - Math.floor(college.stars));
        
        const card = document.createElement('div');
        card.className = 'result-card';
        if(index === 0) card.classList.add('top-result');
        
        card.innerHTML = `
            <div class="result-rank">#${index + 1}</div>
            <div class="result-header">
                <h3>${college.name}</h3>
                <span class="result-location"><i class="fas fa-map-marker-alt"></i> ${college.location}</span>
            </div>
            
            <div class="result-score">
                <div class="score-circle">
                    <span class="score-value">${college.score}</span>
                    <span class="score-label">/10</span>
                </div>
                <div class="stars-display">
                    ${stars}
                    <span class="stars-value">${college.stars}/5</span>
                </div>
            </div>
            
            <div class="result-details">
                <p><i class="fas fa-rupee-sign"></i> <strong>Fees:</strong> ${college.fees}</p>
                <p><i class="fas fa-briefcase"></i> <strong>Placement:</strong> ${college.placement}</p>
                <p><i class="fas fa-check-circle"></i> <strong>Match:</strong> Excellent</p>
            </div>
            
            <div class="result-actions">
                <button class="btn btn-details" onclick="viewCollegeDetails('${college.name}')">
                    <i class="fas fa-info-circle"></i> Details
                </button>
                <button class="btn btn-save">
                    <i class="fas fa-bookmark"></i> Save
                </button>
            </div>
        `;
        
        grid.appendChild(card);
    });
}

function viewCollegeDetails(name) {
    alert(`Detailed view for ${name} coming soon!`);
}
</script>
{% endblock %}